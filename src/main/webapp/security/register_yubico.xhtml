<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <f:view contentType="text/html">

        <h:head>
            <title><ui:insert name="title">BioBankCloud Registration</ui:insert></title>
            <linkre rel="stylesheet" type="text/css" href="#{resource['/css/layout.css']}" />
            <link rel="stylesheet" type="text/css" href="#{resource['/css/security.css']}" />

        </h:head>

        <h:body>
            <ui:insert name="titleBar" >
                <ui:include src="/bbc/lims/titleBar.xhtml" />       
            </ui:insert>
            <div align="center">

                <p:layout  style="margin:0px auto; border: 0px none; width: 80%; " >

                    <p:layoutUnit position="east" style="border: 0px none; width:50%; height: 500px;">
                        <ul class="register_banner">
                            <h3 align="left">Why Yubikey 2-Step verification?</h3>
                        </ul>

                        <div  id="mobile_user_guide" align="left">     
                            <p>
                                It's easier than you think for someone to steal your password.
                                <br></br>
                                Any of these common actions could put you at risk of having your password stolen:
                                <ul>
                                    <li>Using the same password on more than one site</li>
                                    <li>Downloading software from the Internet</li>
                                    <li>Clicking on links in email messages</li>
                                </ul>
                                2-Step Verification can help keep bad guys out, even if they have your password.

                                <br></br>

                                <p style="width: 500px;">
                                    The Yubikey is a hardware authentication device that changes passwords every time it is used. 
                                    <em>Yubikey authentication is an option for users who don't use mobile devices for authentication.</em>
                                </p>

                                <div align="center">
                                    <p:graphicImage library="images" name="icons/yubikey.png" height="150px;" width="150px;"></p:graphicImage>
                                </div>
                                <br></br>
                                <p style="width: 500px;">
                                    In order to use Yubikey verification you need to insert the device into the USB port and press a button.
                                </p>

                                <div align="center">
                                    <p:graphicImage library="images" name="icons/yubiko.jpg" height="200px;" width="200px;"></p:graphicImage>
                                </div>
                                <br></br>                           
                                <p style="width: 500px;">
                                    Every time you press a button a new one-time password will be generated. You will be required to provide this one-time password as PIN in addition to your password.
                                </p>
                            </p>
                        </div>
                   
                    </p:layoutUnit>    

                    <div align="left">
                        <p:layoutUnit position="center" style="border: 0px none; width:50%; height: 500px">

                            <ul class="register_banner">
                                <h3 align="left">Request Yubikey Account</h3>
                            </ul>

                            <h:form > 

                                <h:panelGrid columns="2" style="font-size: 12px;">			
                                    <p:outputLabel for="fname" value="First name" style="font-weight:bold"/>
                                    <p:inputText id="fname" value="#{userRegistration.fname}" size="40"
                                                 required="true"
                                                 requiredMessage="Enter Name" />

                                    <p:outputLabel for="lname" value="Last name" style="font-weight:bold"/>
                                    <p:inputText id="lname" value="#{userRegistration.lname}" size="40"
                                                 required="true"
                                                 requiredMessage="Enter Last Name"/>

                                    <p:outputLabel for="email" value="Email" style="font-weight:bold"/>
                                    <p:inputText id="email" value="#{userRegistration.mail}" size="40"
                                                 required="true"
                                                 requiredMessage="Enter Email">
                                        <f:validator binding="#{usernameValidator}" />
                                    </p:inputText>    

                                    <p:outputLabel for="tel" value="Tel" style="font-weight:bold"/>
                                    <p:inputText id="tel" value="#{userRegistration.tel}" size="40"
                                                 validatorMessage="Invalid tel number">
                                        <f:validateRegex pattern="^([+]?[\d]+)?$" />
                                    </p:inputText>

                                    <p:outputLabel for="address1" value="co" style="font-weight:bold" />
                                    <p:inputText id="address1" value="#{userRegistration.address1}" required="true" size="40"
                                                 requiredMessage="Enter co">
                                    </p:inputText>

                                    <p:outputLabel for="address2" value="Street" style="font-weight:bold" />
                                    <p:inputText id="address2" value="#{userRegistration.address2}" required="true"
                                                 requiredMessage="Enter street" size="40">
                                    </p:inputText>

                                    <p:outputLabel for="city1" value="City" style="font-weight:bold" />
                                    <p:inputText id="city1" value="#{userRegistration.city}"  required="true"
                                                 requiredMessage="Enter city" size="40">
                                    </p:inputText>

                                    <p:outputLabel for="zip1" value="Postal code" style="font-weight:bold" />
                                    <p:inputText id="zip1" value="#{userRegistration.postalcode}" required="true"
                                                 requiredMessage="Enter postalcode" size="40">
                                    </p:inputText>

                                    <p:outputLabel for="country1" value="Country" style="font-weight:bold" />
                                    <p:inputText id="country1" value="#{userRegistration.country}"  required="true"
                                                 requiredMessage="Enter your country" size="40">
                                    </p:inputText>

                                    <p:outputLabel for="sec_question1" value="Security Question" style="font-weight:bold"/>
                                    <p:selectOneMenu id="sec_question1" value="#{userRegistration.security_question}"
                                                     required="true"
                                                     requiredMessage="Select security question" >
                                        <f:selectItem itemLabel="Select Security Question" itemValue="" />
                                        <f:selectItem itemLabel="Who is your favorite historical figure?" itemValue="history" />
                                        <f:selectItem itemLabel="What is name of your favorite teacher?" itemValue="teacher" />
                                        <f:selectItem itemLabel="What is your first phone number?" itemValue="phone" />
                                        <f:selectItem itemLabel="What is the name of your favorite childhood friend?" itemValue="friend" />

                                    </p:selectOneMenu>  

                                    <p:outputLabel for="answer1" value="Answer" style="font-weight:bold"/>
                                    <p:inputText id="answer1" value="#{userRegistration.security_answer}" size="40"
                                                 required="true"
                                                 requiredMessage="Enter answer">
                                    </p:inputText>  

                                    <p:outputLabel for="pass0" value="Password" style="font-weight:bold"/>
                                    <p:password id="pass0" value="#{userRegistration.password}" 
                                                required="true" size="40"
                                                requiredMessage="Enter password">
                                        <f:validator validatorId="passwordValidator" />
                                        <f:attribute name="confirmPassword" value="#{confirmPassword}" />
                                    </p:password>

                                    <p:outputLabel for="pass" value="Password again" style="font-weight:bold"/>
                                    <p:password id="pass" value="#{userRegistration.passwordAgain}" size="40"
                                                requiredMessage="Re-enter password"
                                                binding="#{confirmPassword}"
                                                required="true">
                                    </p:password>

                                    <p:outputLabel for="captcha" value="Enter Captcha" style="font-weight:bold"/>
                                    <p:captcha id ="captcha" label="Captcha" required="true" 
                                               requiredMessage="Enter Captcha"/>

                                    <p:spacer></p:spacer>
                                    <p:messages id="messages" autoUpdate="true" closable="true"/>


                                </h:panelGrid>

                                <div class="register_banner">
                                    <p:commandButton styleClass="team_button button-save" type="submit" value="Register" action="#{userRegistration.registerYubikey()}" />
                                    <p:commandButton styleClass="team_button button-save" type="submit" value="Cancel" action="welcome" process="@this" style="margin-left: 55px"/>
                                </div>

                            </h:form>     
                        </p:layoutUnit>
                    </div>
                </p:layout>
            </div>
        </h:body>
    </f:view>
</html>
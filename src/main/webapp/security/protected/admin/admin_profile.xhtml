<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      >
    <h:head>
        <title><ui:insert name="title">BioBankCloud LIMS Profile</ui:insert></title>
        <link rel="stylesheet" type="text/css" href="#{resource['/css/profile.css']}" />
        <link rel="stylesheet" type="text/css" href="#{resource['/css/layout.css']}" />
        <meta http-equiv="refresh" content="#{facesContext.externalContext.sessionMaxInactiveInterval};url=#{request.contextPath}/index.xhtml"/>

    </h:head>

    <h:body>
        <ui:insert name="titleBar" >
            <ui:include src="/bbc/lims/titleBar.xhtml"  /> 
        </ui:insert>

        <p:growl id="growl" life="2000" showDetail="true" severity="info" autoUpdate="true"/>


        <div align="center" class="UserProfile">

            <div class="PersonalInfo">
                <h3 > Personal Info</h3>

                <p:panelGrid columns="4" styleClass="PersonalIfo">

                    <p:column>
                        <h3 style="color: rgba(0, 0, 0, 0.87); font-weight: 400;">Name</h3>
                    </p:column>   

                    <p:column>
                        <h3 style="color: rgba(0, 0, 0, 0.54); font-weight: 400;"> 
                            #{adminProfileAministration.editingUser.title} #{adminProfileAministration.editingUser.fname} #{adminProfileAministration.editingUser.lname} 
                        </h3>
                    </p:column>

                    <p:column>
                        <h3 style="color: rgba(0, 0, 0, 0.87); font-weight: 400;">Member Since</h3>
                    </p:column>   

                    <p:column>
                        <h3 style="color: rgba(0, 0, 0, 0.54); font-weight: 400;"> 
                            #{adminProfileAministration.editingUser.activated}
                        </h3>
                    </p:column>

                    <p:column>
                        <h3 style="color: rgba(0, 0, 0, 0.87); font-weight: 400;">Email</h3>
                    </p:column>

                    <p:column>
                        <h3 style="color: rgba(0, 0, 0, 0.54); font-weight: 400;"> #{adminProfileAministration.editingUser.email}  </h3>
                    </p:column>

                    <p:column>
                        <h3 style="color: rgba(0, 0, 0, 0.87); font-weight: 400;">Phone</h3>
                    </p:column>

                    <p:column>
                        <h3 style="color: rgba(0, 0, 0, 0.54); font-weight: 400;"> #{adminProfileAministration.editingUser.mobile}  </h3>
                    </p:column>
                </p:panelGrid>

                    
            </div>
                
            <br></br>
            <div class="PersonalInfo">
                    <h3 > Account Info</h3>


                        <p:panelGrid columns="2" styleClass="PersonalIfo" id="account_status">

                        <p:column>
                            <h3 style="color: rgba(0, 0, 0, 0.87); font-weight: 400;">Current User Status</h3>
                        </p:column>

                        
                    <p:column>
                       <h3 style="color: rgba(0, 0, 0, 0.54); font-weight: 400;">       #{adminProfileAministration.editStatus}</h3>
                 
                    </p:column>

                        <p:column>
                            <h3 style="color: rgba(0, 0, 0, 0.87); font-weight: 400;">Current BiobankCloud Roles</h3>
                        </p:column>

                        <p:column >

                            <p:dataGrid  value="#{adminProfileAministration.currentGroups}" 
                                     var="role" emptyMessage="No roles associated with this user."
                                     >
                     
                            <h3 style="color: rgba(0, 0, 0, 0.54); font-weight: 400;">

                                    #{role}
                                </h3>     
                            </p:dataGrid>

                        </p:column>   

                        <p:column>
                            <h3 style="color: rgba(0, 0, 0, 0.87); font-weight: 400;">Last Login</h3>
                        </p:column>

                        <p:column>
                            <h3 style="color: rgba(0, 0, 0, 0.54); font-weight: 400;">
                                #{adminProfileAministration.login.loginDate} from #{adminProfileAministration.login.ip} with #{adminProfileAministration.login.browser}
                            </h3> 
                        </p:column>

                        <p:column>
                            <h3 style="color: rgba(0, 0, 0, 0.87); font-weight: 400;">Last Password Change</h3>
                        </p:column>

                        <p:column>
                            <h3 style="color: rgba(0, 0, 0, 0.54); font-weight: 400;">
                                #{adminProfileAministration.editingUser.passwordChanged}
                            </h3>      
                        </p:column>


                    </p:panelGrid>

    
                    
            </div>
            
            <br></br>
            
            <div class="PersonalInfo">
                    <h3 >Change Settings</h3>

            
            <p:panelGrid columns="2">
                
                
            <h:form id="add_role" >
                <h:panelGrid  columns="4" >    

                <p:outputLabel for="addRole" value="Add Role" />					
                    <p:selectOneMenu id="addRole"
                                     value="#{adminProfileAministration.new_group}" 
                                     editable="false">

                        <f:selectItem itemValue="#"
                                      itemLabel="Add Role" 
                            />
                        <f:selectItems value="#{adminProfileAministration.newGroups}" />
                    </p:selectOneMenu>
                  
                <p:commandButton  type="submit" 
                                  value="Update"
                                  update=":account_status :remove_role :add_role :user_stat"
                                  action="#{adminProfileAministration.addRoleByAdmin()}"/> 
                 </h:panelGrid>
                                  
            </h:form>        

                   <h:form id="user_stat">
            
                <h:panelGrid  columns="4">    

                    <p:outputLabel for="statChoose" value="Status"/>					
                    <p:selectOneMenu id="statChoose" 
                                     value="#{adminProfileAministration.selectedStatus}" 
                                     >
                                     

                        <f:selectItem itemLabel="Change Status"
                                      itemValue="#"
                                      />
                        <f:selectItems value="#{adminProfileAministration.status}"/>                                       
                    </p:selectOneMenu>
                    
                <p:commandButton  type="submit" 
                                  value="Update"
                                  update=":account_status :user_stat"
                                  action="#{adminProfileAministration.updateStatusByAdmin()}"/> 
              
                </h:panelGrid>
                
             </h:form>
            
            <h:form id="remove_role">
                <h:panelGrid  columns="4" >    

                    <p:outputLabel for="removeRole" value="Remove Role" />					
                    <p:selectOneMenu id="removeRole" 
                                     value="#{adminProfileAministration.selectedGroup}">
                        <f:selectItem itemValue="#" itemLabel="Remove Role" 
                                      noSelectionOption="true"/>
                        <f:selectItems value="#{adminProfileAministration.currentGroups}" />
                    </p:selectOneMenu>
  
                        
                <p:commandButton  type="submit" 
                                  value="Update"
                                  update=":account_status :add_role :remove_role :user_stat"
                                  action="#{adminProfileAministration.removeRoleByAdmin()}"/> 
              
                </h:panelGrid>
              
            </h:form>
            </p:panelGrid>

              <div align="left" style="padding-top: 20px;">
            
                      <p:commandLink type="submit" value="Back to User Management Page" action="userMgmt" immediate="true"/>

              </div>
     </div>
        </div>
               
    </h:body>
</html>
